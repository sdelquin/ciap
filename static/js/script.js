// Generated by CoffeeScript 1.10.0
var calculate, detect_enter, validate;

jQuery(function() {
  $("#email-section").hide();
  $("#btn-calc").on("click", calculate);
  $("#input-price").on("keypress", detect_enter);
  return $("#gear").css("visibility", "hidden");
});

calculate = function() {
  if (validate()) {
    $("#gear").css("visibility", "visible");
    return $.ajax({
      dataType: "html",
      url: "/ajax",
      data: {
        price: $("#input-price").val()
      },
      success: function(data) {
        $(".result").html(data);
        return $("#email-section").show();
      },
      complete: function() {
        return $("#gear").css("visibility", "hidden");
      }
    });
  } else {
    return $(".result").html("");
  }
};

validate = function() {
  var price;
  price = $("#input-price").val();
  if (/^[-+]?([0-9]*[.,][0-9]+$|^[0-9]+$)/.test(price)) {
    $("#input-price").val(price.replace(",", "."));
    $(".error").html("");
    return true;
  } else {
    $(".error").html("This is not a number!");
    $("#email-section").hide();
    return false;
  }
};

detect_enter = function(event) {
  if (event.keyCode === 13) {
    return calculate();
  }
};
